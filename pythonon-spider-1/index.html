<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta name="baidu-site-verification" content="vi604da58U"><meta name="google-site-verification" content="JwzmnANXlpmQlhwaSORuqpEB6P3Sr-tRhw4R_XDRcEc"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>python3爬虫urllib | AngelNI's Blog</title><meta name="description" content="python3爬虫urllib"><meta name="keywords" content="python"><meta name="author" content="Hui Ning"><meta name="copyright" content="Hui Ning"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="crossorigin"/><link rel="preconnect" href="https://hm.baidu.com"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="python3爬虫urllib"><meta name="twitter:description" content="python3爬虫urllib"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/169.webp"><meta property="og:type" content="article"><meta property="og:title" content="python3爬虫urllib"><meta property="og:url" content="https://angelni.github.io/pythonon-spider-1/"><meta property="og:site_name" content="AngelNI's Blog"><meta property="og:description" content="python3爬虫urllib"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/169.webp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/AngelNI.github.io/css/index.css" ><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://angelni.github.io/pythonon-spider-1/"><link rel="prev" title="实战:爬取猫眼电影TOP100" href="https://angelni.github.io/spider-maoyantop100/"><link rel="next" title="实践：爬取前程无忧数据并做分析" href="https://angelni.github.io/51job/"><script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>(adsbygoogle = window.adsbygoogle || []).push({
  google_ad_client: '784-559-7194',
  enable_page_level_ads: 'true'
});</script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?c0aadf140996faae5fdf1fa9ef178180";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-144678502-1', 'auto');
ga('send', 'pageview');
</script><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/AngelNI.github.io/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"We didn't find any results for the search: ${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://angelni.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Dark Mode Activated Manually","night_to_day":"Light Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"},
  baiduPush: true,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false
  
}</script><script src="https://www.zrahh.com/js/instantclick-1.2.2.js" type="module"></script><script src="activate-power-mode.js"></script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/avatar.png" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/AngelNI.github.io/archives/"><div class="headline">Articles</div><div class="length_num">153</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/AngelNI.github.io/tags/"><div class="headline">Tags</div><div class="length_num">98</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/AngelNI.github.io/categories/"><div class="headline">Categories</div><div class="length_num">7</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/link/"><i class="fa-fw fa fa-link"></i><span> Friends</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://pan.angelni.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-bullhorn"></i><span> Pan</span></a></li><li><a class="site-page" href="http://angelni.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-bullhorn"></i><span> little Blog</span></a></li><li><a class="site-page" href="/AngelNI.github.io/photo"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/suisuinian/"><i class="fa-fw fa fa-bullhorn"></i><span> My Voice</span></a></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#基本库-urllib-的使用"><span class="toc-number">1.</span> <span class="toc-text"> 基本库 urllib 的使用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#urllib-简介"><span class="toc-number">1.1.</span> <span class="toc-text"> urllib 简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllibrequest"><span class="toc-number">1.2.</span> <span class="toc-text"> urllib.request</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibrequesturlopen"><span class="toc-number">1.2.1.</span> <span class="toc-text"> urllib.request.urlopen()</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#添加参数"><span class="toc-number">1.2.1.1.</span> <span class="toc-text"> 添加参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibrequestrequest"><span class="toc-number">1.2.2.</span> <span class="toc-text"> urllib.request.Request()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibrequesturlretrieve"><span class="toc-number">1.2.3.</span> <span class="toc-text"> urllib.request.urlretrieve()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urlliberror-异常处理"><span class="toc-number">1.3.</span> <span class="toc-text"> urllib.error 异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#urlerror"><span class="toc-number">1.3.1.</span> <span class="toc-text"> URLError</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#httperror"><span class="toc-number">1.3.2.</span> <span class="toc-text"> HTTPError</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#进阶用法"><span class="toc-number">1.3.3.</span> <span class="toc-text"> 进阶用法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllibparse-解析-url"><span class="toc-number">1.4.</span> <span class="toc-text"> urllib.parse 解析 URL</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurlencode"><span class="toc-number">1.4.1.</span> <span class="toc-text"> urllib.parse.urlencode()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseparse_qs"><span class="toc-number">1.4.2.</span> <span class="toc-text"> urllib.parse.parse_qs()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseparse_qsl"><span class="toc-number">1.4.3.</span> <span class="toc-text"> urllib.parse.parse_qsl()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurlparse"><span class="toc-number">1.4.4.</span> <span class="toc-text"> urllib.parse.urlparse()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurlunparse"><span class="toc-number">1.4.5.</span> <span class="toc-text"> urllib.parse.urlunparse()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurlsplit"><span class="toc-number">1.4.6.</span> <span class="toc-text"> urllib.parse.urlsplit()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurlunsplit"><span class="toc-number">1.4.7.</span> <span class="toc-text"> urllib.parse.urlunsplit()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseurljoin"><span class="toc-number">1.4.8.</span> <span class="toc-text"> urllib.parse.urljoin()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparsequote"><span class="toc-number">1.4.9.</span> <span class="toc-text"> urllib.parse.quote()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#urllibparseunquote"><span class="toc-number">1.4.10.</span> <span class="toc-text"> urllib.parse.unquote()</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#urllibrobotparser-爬取权限判断"><span class="toc-number">1.5.</span> <span class="toc-text"> urllib.robotparser 爬取权限判断</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#robots-协议简介"><span class="toc-number">1.5.1.</span> <span class="toc-text"> Robots 协议简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#robotfileparser-类常用方法"><span class="toc-number">1.5.2.</span> <span class="toc-text"> RobotFileParser 类常用方法</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/169.webp)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/AngelNI.github.io/">AngelNI's Blog</a></span><span class="pull_right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> Search</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/link/"><i class="fa-fw fa fa-link"></i><span> Friends</span></a></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="http://pan.angelni.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-bullhorn"></i><span> Pan</span></a></li><li><a class="site-page" href="http://angelni.cn/" target="_blank" rel="noopener"><i class="fa-fw fa fa-bullhorn"></i><span> little Blog</span></a></li><li><a class="site-page" href="/AngelNI.github.io/photo"><i class="fa-fw fa fa-film"></i><span> Photo</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/AngelNI.github.io/suisuinian/"><i class="fa-fw fa fa-bullhorn"></i><span> My Voice</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">python3爬虫urllib</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-05-22 13:25:12"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-05-22</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-05-24 16:24:56"><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-05-24</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/AngelNI.github.io/categories/python/">python</a></span></div><div class="meta-secondline"> <span class="post-meta-wordcount"><i class="post-meta__icon fa fa-file-word-o" aria-hidden="true"></i><span>Word count:</span><span class="word-count">3.3k</span><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-clock-o" aria-hidden="true"></i><span>Reading time: 14 min</span></span></div><div class="meta-thirdline"><span class="post-meta-pv-cv"><span class="post-meta__separator">|</span><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"><span class="post-meta__separator">|</span><i class="post-meta__icon fa fa-comment-o" aria-hidden="true"></i><span>Comments:</span><a href="/AngelNI.github.io/pythonon-spider-1/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/AngelNI.github.io/pythonon-spider-1/" itemprop="commentCount"></span></a></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div id="article-container"><h1 id="基本库-urllib-的使用"><a class="markdownIt-Anchor" href="#基本库-urllib-的使用"></a> 基本库 urllib 的使用</h1>
<h2 id="urllib-简介"><a class="markdownIt-Anchor" href="#urllib-简介"></a> urllib 简介</h2>
<p>在 Python 中有两种方式可以发送 HTTP 请求，分别是自带的 urllib 库和第三方的 requests 库。</p>
<div class="note success">
            <p>urllib 库：Python 内置的 HTTP 请求库，无需额外安装即可使用；Python 2 中有 urllib 和 urllib2 两个库来实现请求的发送，Python 3 中统一为 urllib。官方文档：<a href="https://docs.python.org/3/library/urllib.html" target="_blank" rel="noopener">https://docs.python.org/3/library/urllib.html</a></p>
          </div>	
<p><strong>urllib所包含的常用模块</strong></p>
<ol>
<li>urllib.request：模拟发送请求；</li>
<li>urllib.error：异常处理模块，用于捕获异常；</li>
<li>urrllib.parse：解析、拆分、合并URL</li>
<li>urllib.robotparser：读取网站的robots.txt文件，判断哪些内容可以爬取</li>
</ol>
<p><strong>urllib.request所包含的常用方法</strong></p>
<ol>
<li>urllib.request.urlopen()：打开网址URL，这可以是一个字符串或一个 Request对象；</li>
<li>urllib.request.Request()：在请求的时候传入一些 headers 等信息；</li>
<li>urllib.request.urlretrieve()：将获取的URL的内容写到文件目录中去。</li>
</ol>
<p><strong>urllib.request所包含的常用方法</strong></p>
<ol>
<li>URLError：继承自 OSError 类，是 error 异常模块的基类，由 request 模块产生的异常都可以通过捕获这个类来处理。</li>
<li>HTTPError：是 URLError 的子类，专门用来处理 HTTP 请求错误，比如认证请求失败等。</li>
</ol>
<p><strong>urllib.parse 所包含的常用方法</strong></p>
<ol>
<li>urllib.parse.urlencode()：将字典参数序列化为 GET 请求参数；</li>
<li>urllib.parse.parse_qs()：将 GET 请求参数反序列化转回字典；</li>
<li>urllib.parse.parse_qsl()：将参数转化为元组组成的列表；</li>
<li>urllib.parse.urlparse()：对 URL 进行分段（返回6个结果）；</li>
<li>urllib.parse.urlunparse()：对 URL 进行组合（长度必须为6）；</li>
<li>urllib.parse.urlsplit()：对 URL 进行分段（不单独解析params部分，返回5个结果）；</li>
<li>urllib.parse.urlunsplit()：对 URL 进行组合（长度必须为5）</li>
<li>urllib.parse.urljoin()：对 URL 进行组合（没有长度限制，给定两个参数，自动分析 scheme、netloc 和 path 这 3 个内容并对新链接缺失的部分进行补充，最后返回结果）；</li>
<li>urllib.parse.quote()：将内容转化为 URL 编码格式；</li>
<li>urllib.parse.unquote()：对 URL 进行解码。</li>
</ol>
<p><strong>urllib.robotparser 所包含的类</strong></p>
<ol>
<li>RobotFileParser：根据网站的 robots.txt 文件来判断一个爬取爬虫是否有权限来爬取这个网页</li>
</ol>
<h2 id="urllibrequest"><a class="markdownIt-Anchor" href="#urllibrequest"></a> urllib.request</h2>
<h3 id="urllibrequesturlopen"><a class="markdownIt-Anchor" href="#urllibrequesturlopen"></a> urllib.request.urlopen()</h3>
<p>基本使用方法</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">urllib.request.urlopen(url, data=<span class="literal">None</span>, [timeout,]*, cafile=<span class="literal">None</span>, capath=<span class="literal">None</span>, cadefault=<span class="literal">False</span>, context=<span class="literal">None</span>)</span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request </span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(<span class="string">'https://angelni.github.io/'</span>)</span><br><span class="line">print(response)</span><br></pre></td></tr></table></figure>
<p>输出响应对象的类型和属性：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request </span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(<span class="string">'https://angelni.github.io/'</span>)</span><br><span class="line">print(type(response))</span><br><span class="line">print(response.status)</span><br><span class="line">print(response.getheaders())</span><br><span class="line">print(response.getheader(<span class="string">'Server'</span>))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;class &#39;http.client.HTTPResponse&#39;&gt;</span><br><span class="line">200</span><br><span class="line">[(&#39;Connection&#39;, &#39;close&#39;), (&#39;Content-Length&#39;, &#39;36930&#39;), (&#39;Content-Type&#39;, &#39;text&#x2F;html; charset&#x3D;utf-8&#39;), (&#39;Server&#39;, &#39;GitHub.com&#39;), (&#39;Strict-Transport-Security&#39;, &#39;max-age&#x3D;rict-Transport-Security&#39;, &#39;max-age&#x3D;31556952&#39;), (&#39;Last-Modified&#39;, &#39;Mon, 11 May 2020 05:38:18 GMT&#39;), (&#39;ETag&#39;, &#39;&quot;5eb8e4ca-9042&quot;&#39;), (&#39;A(&#39;Expires&#39;, &#39;Thu, 21 May 2020 20:17ccess-Control-Allow-Origin&#39;, &#39;*&#39;), (&#39;Expires&#39;, &#39;Thu, 21 May 2020 20:17:51 GMT&#39;), (&#39;Cache-Control&#39;, &#39;max-age&#x3D;600&#39;), (&#39;X-Proxy-Cache&#39;, (&#39;Accept-Ranges&#39;, &#39;bytes&#39;), (&#39;Dat, &#39;MISS&#39;), (&#39;X-GitHub-Request-Id&#39;, &#39;9112:45A4:22C0FB:24F624:5EC6DF95&#39;), (&#39;Accept-Ranges&#39;, &#39;bytes&#39;), (&#39;Date&#39;, &#39;Fri, 22 May 2020 05:4IT&#39;), (&#39;X-Cache-Hits&#39;, &#39;1&#39;), (&#39;X-Ti2:11 GMT&#39;), (&#39;Via&#39;, &#39;1.1 varnish&#39;), (&#39;Age&#39;, &#39;108&#39;), (&#39;X-Served-By&#39;, &#39;cache-tyo19939-TYO&#39;), (&#39;X-Cache&#39;, &#39;HIT&#39;), (&#39;X-Cache-Hits&#39;, &#39;1&#39;&#39;)]), (&#39;X-Timer&#39;, &#39;S1590126131.497095,VS0,VE1&#39;), (&#39;Vary&#39;, &#39;Accept-Encoding&#39;), (&#39;X-Fastly-Request-ID&#39;, &#39;d0682d145390665c6ad5fa6b629b2af3a18a7654&#39;)]</span><br><span class="line">GitHub.com</span><br></pre></td></tr></table></figure>
<h4 id="添加参数"><a class="markdownIt-Anchor" href="#添加参数"></a> 添加参数</h4>
<p><strong>timeout参数</strong></p>
<p>timeout 设置为0.1，0.1秒过后服务器没有响应，便会抛出 URLError 异常</p>
<p>举例</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">response = urllib.request.urlopen(<span class="string">'http://httpbin.org/get'</span>, timeout=<span class="number">0.1</span>)  </span><br><span class="line">print(response.read())</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">During handling of the above exception, another exception occurred:</span><br><span class="line"></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File &quot;f:\C-and-Python-Algorithn\python\Spider\1.py&quot;, line 3, in &lt;module&gt;</span><br><span class="line">    response &#x3D; urllib.request.urlopen(&#39;https:&#x2F;&#x2F;angelni.github.io&#x2F;&#39;, timeout&#x3D;0.1)  </span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 223, in urlopen</span><br><span class="line">    return opener.open(url, data, timeout)</span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 526, in open</span><br><span class="line">    response &#x3D; self._open(req, data)</span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 544, in _open</span><br><span class="line">    &#39;_open&#39;, req)</span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 504, in _call_chain</span><br><span class="line">    result &#x3D; func(*args)</span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 1361, in https_open</span><br><span class="line">    context&#x3D;self._context, check_hostname&#x3D;self._check_hostname)</span><br><span class="line">  File &quot;E:\python\lib\urllib\request.py&quot;, line 1320, in do_open</span><br><span class="line">    raise URLError(err)</span><br><span class="line">urllib.error.URLError: &lt;urlopen error _ssl.c:825: The handshake operation timed out&gt;</span><br></pre></td></tr></table></figure>
<h3 id="urllibrequestrequest"><a class="markdownIt-Anchor" href="#urllibrequestrequest"></a> urllib.request.Request()</h3>
<p>Request() 方法可以在请求的时候传入一些 data、headers 等信息</p>
<p>Request() 的构造方法：</p>
<div class="note success">
            <p>class urllib.request.Request(url, data=None, headers={}, origin_req_host=None, unverifiable=False, method=None)</p>
          </div>	
<p>构造方法各个参数的解释：</p>
<ul>
<li>url：用于请求 URL，这是必传参数，其他都是可选参数。</li>
<li>data：如果要传，必须传 bytes（字节流）类型的。如果它是字典，可以先用 urllib.parse 模块里的 urlencode() 编码。</li>
<li>headers：是一个字典，它就是请求头，可以在构造请求时通过 headers 参数直接构造，也可以通过调用请求实例的 add_header() 方法添加。添加请求头最常用的用法就是通过修改 User-Agent 来伪装浏览器，默认的 User-Agent 是 Python-urllib，我们可以通过修改它来伪装浏览器。</li>
<li>origin_req_host：指的是请求方的 host 名称或者 IP 地址。</li>
<li>unverifiable：表示这个请求是否是无法验证的，默认是 False，意思就是说用户没有足够权限来选择接收这个请求的结果。例如，我们请求一个 HTML 文档中的图片，但是我们没有自动抓取图像的权限，这时 unverifiable 的值就是 True。</li>
<li>method：是一个字符串，用来指示请求使用的方法，比如 GET、POST 和 PUT 等。</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> urllib.parse</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://www.baidu.com/'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定制要伪装的头部</span></span><br><span class="line">headers = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36'</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 构建请求对象</span></span><br><span class="line">request = urllib.request.Request(url=url, headers=headers)</span><br><span class="line"><span class="comment"># 发送请求</span></span><br><span class="line">response = urllib.request.urlopen(request)</span><br><span class="line">print(response.read().decode())</span><br></pre></td></tr></table></figure>
<h3 id="urllibrequesturlretrieve"><a class="markdownIt-Anchor" href="#urllibrequesturlretrieve"></a> urllib.request.urlretrieve()</h3>
<p>将获取到的 URL 内容保存到当前文件夹，简单举例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"></span><br><span class="line">url = <span class="string">'https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/avatar.png'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># response = urllib.request.urlopen(image_url)</span></span><br><span class="line"><span class="comment"># with open('angelni.png', 'wb') as fp:</span></span><br><span class="line"><span class="comment">#    fp.write(response.read())</span></span><br><span class="line"></span><br><span class="line">urllib.request.urlretrieve(url, <span class="string">'angelni.png'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="urlliberror-异常处理"><a class="markdownIt-Anchor" href="#urlliberror-异常处理"></a> urllib.error 异常处理</h2>
<h3 id="urlerror"><a class="markdownIt-Anchor" href="#urlerror"></a> URLError</h3>
<p>如果打开一个不存在的页面，就会出现 URLError 错误，该错误有一个 reason 属性，用于返回错误的原因。简单举例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request, error  </span><br><span class="line"><span class="keyword">try</span>:  </span><br><span class="line">    response = request.urlopen(<span class="string">'https://angelni.github.io/index/'</span>)  </span><br><span class="line"><span class="keyword">except</span> error.URLError <span class="keyword">as</span> e:  </span><br><span class="line">    print(e.reason)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Not Found</span><br></pre></td></tr></table></figure>
<h3 id="httperror"><a class="markdownIt-Anchor" href="#httperror"></a> HTTPError</h3>
<p>URLError 的子类，专门用来处理 HTTP 请求错误，比如认证请求失败等。它有如下3个属性：</p>
<ul>
<li>code：返回 HTTP 状态码，比如 404 表示网页不存在，500 表示服务器内部错误等。</li>
<li>reason：同父类一样，用于返回错误的原因。</li>
<li>headers：返回请求头。</li>
</ul>
<p>简单举例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request, error  </span><br><span class="line"><span class="keyword">try</span>:  </span><br><span class="line">    response = request.urlopen(<span class="string">'https://angelni.github.io/index/'</span>)  </span><br><span class="line"><span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:  </span><br><span class="line">    print(e.code, e.reason, e.headers)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">404 Not Found Connection: close</span><br><span class="line">Content-Length: 14054</span><br><span class="line">Content-Type: text&#x2F;html; charset&#x3D;utf-8</span><br><span class="line">Server: GitHub.com</span><br><span class="line">Strict-Transport-Security: max-age&#x3D;31556952</span><br><span class="line">ETag: &quot;5eb8e4ca-36e6&quot;</span><br><span class="line">Access-Control-Allow-Origin: *</span><br><span class="line">X-Proxy-Cache: MISS</span><br><span class="line">X-GitHub-Request-Id: 6496:45A5:369AC6:3A1948:5EC76895</span><br><span class="line">Accept-Ranges: bytes</span><br><span class="line">Date: Fri, 22 May 2020 05:59:06 GMT</span><br><span class="line">Via: 1.1 varnish</span><br><span class="line">Age: 403</span><br><span class="line">X-Served-By: cache-tyo19926-TYO</span><br><span class="line">X-Cache: HIT</span><br><span class="line">X-Cache-Hits: 1</span><br><span class="line">X-Timer: S1590127147.595289,VS0,VE0</span><br><span class="line">Vary: Accept-Encoding</span><br><span class="line">X-Fastly-Request-ID: b2a7e9ca856a64157cd67ea4a59e449062baa169</span><br></pre></td></tr></table></figure>
<h3 id="进阶用法"><a class="markdownIt-Anchor" href="#进阶用法"></a> 进阶用法</h3>
<p>因为 URLError 是 HTTPError 的父类，所以可以先选择捕获子类的错误，再去捕获父类的错误，前面的代码改进：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib <span class="keyword">import</span> request, error  </span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:  </span><br><span class="line">    response = request.urlopen(<span class="string">'https://angelni.github.io/index/'</span>)  </span><br><span class="line"><span class="keyword">except</span> error.HTTPError <span class="keyword">as</span> e:  </span><br><span class="line">    print(e.reason, e.code, e.headers)  </span><br><span class="line"><span class="keyword">except</span> error.URLError <span class="keyword">as</span> e:  </span><br><span class="line">    print(e.reason)  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">    print(<span class="string">'Request Successfully'</span>)</span><br></pre></td></tr></table></figure>
<h2 id="urllibparse-解析-url"><a class="markdownIt-Anchor" href="#urllibparse-解析-url"></a> urllib.parse 解析 URL</h2>
<h3 id="urllibparseurlencode"><a class="markdownIt-Anchor" href="#urllibparseurlencode"></a> urllib.parse.urlencode()</h3>
<p>将字典参数序列化为 GET 请求参数，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'ie'</span>: <span class="string">'utf-8'</span>,</span><br><span class="line">    <span class="string">'wd'</span>: <span class="string">'TRHX'</span>,</span><br><span class="line">&#125;</span><br><span class="line">base_url = <span class="string">'http://www.baidu.com?'</span></span><br><span class="line">url = base_url + urlencode(data)</span><br><span class="line">print(url)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com?ie&#x3D;utf-8&amp;wd&#x3D;TRHX</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseparse_qs"><a class="markdownIt-Anchor" href="#urllibparseparse_qs"></a> urllib.parse.parse_qs()</h3>
<p>与 urlencode() 相反，将 GET 请求参数反序列化转回字典，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> parse_qs</span><br><span class="line">query = <span class="string">'name=TRHX&amp;age=20'</span></span><br><span class="line">print(parse_qs(query))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&#123;<span class="string">'name'</span>: [<span class="string">'TRHX'</span>], <span class="string">'age'</span>: [<span class="string">'20'</span>]&#125;</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseparse_qsl"><a class="markdownIt-Anchor" href="#urllibparseparse_qsl"></a> urllib.parse.parse_qsl()</h3>
<p>将参数转化为元组组成的列表，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> parse_qsl</span><br><span class="line">query = <span class="string">'name=TRHX&amp;age=20'</span></span><br><span class="line">print(parse_qsl(query))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">[(<span class="string">'name'</span>, <span class="string">'TRHX'</span>), (<span class="string">'age'</span>, <span class="string">'20'</span>)]</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseurlparse"><a class="markdownIt-Anchor" href="#urllibparseurlparse"></a> urllib.parse.urlparse()</h3>
<p>对 URL 进行分段，返回 6 个结果，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse</span><br><span class="line">result = urlparse(<span class="string">'http://www.baidu.com/index.html;user?id=5#comment'</span>)</span><br><span class="line">print(type(result), result)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">&lt;<span class="class"><span class="keyword">class</span> '<span class="title">urllib</span>.<span class="title">parse</span>.<span class="title">ParseResult</span>'&gt; <span class="title">ParseResult</span><span class="params">(scheme=<span class="string">'http'</span>, netloc=<span class="string">'www.baidu.com'</span>, path=<span class="string">'/index.html'</span>, params=<span class="string">'user'</span>, query=<span class="string">'id=5'</span>, fragment=<span class="string">'comment'</span>)</span></span></span><br></pre></td></tr></table></figure>
<p>返回结果为 ParseResult 类型的对象，含 scheme、netloc、path、params、query 和 fragment 6 个部分，依次代表协议、域名、路径、参数、查询条件、锚点</p>
<h3 id="urllibparseurlunparse"><a class="markdownIt-Anchor" href="#urllibparseurlunparse"></a> urllib.parse.urlunparse()</h3>
<p>与 urlparse() 相反，对 URL 进行组合，传入的参数是一个可迭代对象，长度必须是 6，否则会抛出参数数量不足或者过多的问题，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlunparse  </span><br><span class="line">data = [<span class="string">'http'</span>, <span class="string">'www.baidu.com'</span>, <span class="string">'index.html'</span>, <span class="string">'user'</span>, <span class="string">'a=6'</span>, <span class="string">'comment'</span>]  </span><br><span class="line">print(urlunparse(data))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com&#x2F;index.html;user?a&#x3D;6#comment</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseurlsplit"><a class="markdownIt-Anchor" href="#urllibparseurlsplit"></a> urllib.parse.urlsplit()</h3>
<p>与 urlparse() 方法相似，但是它不再单独解析 params 部分，只返回 5 个结果。params 会合并到 path 中，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlsplit  </span><br><span class="line">result = urlsplit(<span class="string">'http://www.baidu.com/index.html;user?id=5#comment'</span>)  </span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">SplitResult(scheme&#x3D;&#39;http&#39;, netloc&#x3D;&#39;www.baidu.com&#39;, path&#x3D;&#39;&#x2F;index.html;user&#39;, query&#x3D;&#39;id&#x3D;5&#39;, fragment&#x3D;&#39;comment&#39;)</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseurlunsplit"><a class="markdownIt-Anchor" href="#urllibparseurlunsplit"></a> urllib.parse.urlunsplit()</h3>
<p>与 urlunparse() 方法类似，对 URL 进行组合，传入的参数也是一个可迭代对象，长度必须为 5，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlunsplit  </span><br><span class="line">data = [<span class="string">'http'</span>, <span class="string">'www.baidu.com'</span>, <span class="string">'index.html'</span>, <span class="string">'a=6'</span>, <span class="string">'comment'</span>]  </span><br><span class="line">print(urlunsplit(data))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com&#x2F;index.html?a&#x3D;6#comment</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseurljoin"><a class="markdownIt-Anchor" href="#urllibparseurljoin"></a> urllib.parse.urljoin()</h3>
<p>对 URL 进行组合，提供两个 URL 作为两个参数，将会自动分析 URL 的 scheme、netloc 和 path 这 3 个内容并对新链接缺失的部分进行补充，最后返回结果，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urljoin  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com'</span>, <span class="string">'friends.html'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com'</span>, <span class="string">'https://www.itrhx.com/friends.html'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com/friends.html'</span>, <span class="string">'https://www.itrhx.com/friends.html'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com/friends.html'</span>, <span class="string">'https://www.itrhx.com/friends.html?id=2'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com?wd=trhx'</span>, <span class="string">'https://www.itrhx.com/index.html'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'http://www.baidu.com'</span>, <span class="string">'?category=2#comment'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'www.baidu.com'</span>, <span class="string">'?category=2#comment'</span>))  </span><br><span class="line">print(urljoin(<span class="string">'www.baidu.com#comment'</span>, <span class="string">'?category=2'</span>))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">http:&#x2F;&#x2F;www.baidu.com&#x2F;friends.html</span><br><span class="line">https:&#x2F;&#x2F;www.itrhx.com&#x2F;friends.html</span><br><span class="line">https:&#x2F;&#x2F;www.itrhx.com&#x2F;friends.html</span><br><span class="line">https:&#x2F;&#x2F;www.itrhx.com&#x2F;friends.html?id&#x3D;2</span><br><span class="line">https:&#x2F;&#x2F;www.itrhx.com&#x2F;index.html</span><br><span class="line">http:&#x2F;&#x2F;www.baidu.com?category&#x3D;2#comment</span><br><span class="line">www.baidu.com?category&#x3D;2#comment</span><br><span class="line">www.baidu.com?category&#x3D;2</span><br></pre></td></tr></table></figure>
<h3 id="urllibparsequote"><a class="markdownIt-Anchor" href="#urllibparsequote"></a> urllib.parse.quote()</h3>
<p>将内容转化为 URL 编码的格式。当 URL 中带有中文参数时，可以将中文字符转化为 URL 编码，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line">keyword = <span class="string">'中国'</span>  </span><br><span class="line">url = <span class="string">'https://www.baidu.com/s?wd='</span> + quote(keyword)  </span><br><span class="line">print(url)</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.baidu.com&#x2F;s?wd&#x3D;%E4%B8%AD%E5%9B%BD</span><br></pre></td></tr></table></figure>
<h3 id="urllibparseunquote"><a class="markdownIt-Anchor" href="#urllibparseunquote"></a> urllib.parse.unquote()</h3>
<p>与 quote() 方法相反，对 URL 进行解码，示例：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> unquote  </span><br><span class="line">url = <span class="string">'https://www.baidu.com/s?wd=%E4%B8%AD%E5%9B%BD'</span>  </span><br><span class="line">print(unquote(url))</span><br></pre></td></tr></table></figure>
<p>运行结果</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">https:&#x2F;&#x2F;www.baidu.com&#x2F;s?wd&#x3D;中国</span><br></pre></td></tr></table></figure>
<h2 id="urllibrobotparser-爬取权限判断"><a class="markdownIt-Anchor" href="#urllibrobotparser-爬取权限判断"></a> urllib.robotparser 爬取权限判断</h2>
<h3 id="robots-协议简介"><a class="markdownIt-Anchor" href="#robots-协议简介"></a> Robots 协议简介</h3>
<div class="note success">
            <p>Robots 协议即爬虫协议，用来告诉爬虫和搜索引擎哪些页面可以抓取，哪些不可以抓取。它通常是一个叫作 robots.txt 的文本文件，一般放在网站的根目录下。</p>
          </div>	
<p>robots.txt 基本格式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">User-agent:</span><br><span class="line">Disallow:</span><br><span class="line">Allow:</span><br></pre></td></tr></table></figure>
<ul>
<li>User-agent 为搜索爬虫的名称，设置为 * 则表示对任何爬虫皆有效；</li>
<li>Disallow 指定了不允许抓取的目录，设置为 / 则代表不允许抓取所有页面；</li>
<li>Allow 指定了允许抓取的目录，一般和 Disallow 一起使用，一般不会单独使用，用来排除某些限制。</li>
</ul>
<h3 id="robotfileparser-类常用方法"><a class="markdownIt-Anchor" href="#robotfileparser-类常用方法"></a> RobotFileParser 类常用方法</h3>
<p>RobotFileParser 类的声明：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">urllib.robotparser.RobotFileParser(url=<span class="string">''</span>)</span><br></pre></td></tr></table></figure>
<p>常用方法及其解释：</p>
<ul>
<li>set_url：用来设置 robots.txt 文件的链接。如果在创建 RobotFileParser<br />
对象时传入了链接，那么就不需要再用这种方法了。</li>
<li>read：读取 robots.txt 文件并进行分析。此方法执行一个读取和分析操作，若不调用此方法，接下来的判断都会为 False，这个方法不会返回任何内容，但是执行了读取操作。</li>
<li>parse：解析 robots.txt 文件，传入的参数是 robots.txt 某些行的内容，它会按照 robots.txt 的语法规则来分析这些内容。</li>
<li>can_fetch：该方法传入两个参数，第一个是 User-agent，第二个是要抓取的 URL。返回的内容是该搜索引擎是否可以抓取这个 URL，返回结果是 True 或 False。</li>
<li>mtime：返回的是上次抓取和分析 robots.txt 的时间，此方法可以定期检查来抓取最新的 robots.txt。</li>
<li>modified：将当前时间设置为上次抓取和分析 robots.txt 的时间。</li>
</ul>
<p>以简书为例</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> urllib.robotparser <span class="keyword">import</span> RobotFileParser</span><br><span class="line">rp = RobotFileParser()</span><br><span class="line">rp.set_url(<span class="string">'http://www.jianshu.com/robots.txt'</span>)</span><br><span class="line">rp.read()</span><br><span class="line">print(rp.can_fetch(<span class="string">'*'</span>, <span class="string">'https://www.jianshu.com/p/6d9527300b4c'</span>))</span><br><span class="line">print(rp.can_fetch(<span class="string">'*'</span>, <span class="string">"http://www.jianshu.com/search?q=python&amp;page=1&amp;type=collections"</span>))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="literal">False</span></span><br><span class="line"><span class="literal">False</span></span><br></pre></td></tr></table></figure>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">Hui Ning</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://angelni.github.io/pythonon-spider-1/">https://angelni.github.io/pythonon-spider-1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/AngelNI.github.io/tags/python/">python</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/AngelNI/Figure/img/9999.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/2.png" alt="微信"/><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/1.jpg" alt="支付宝"/><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/AngelNI.github.io/spider-maoyantop100/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/172.webp" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">实战:爬取猫眼电影TOP100</div></div></a></div><div class="next-post pull_right"><a href="/AngelNI.github.io/51job/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/AngelNI/Figure/img/343.webp" onerror="onerror=null;src='https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/imgs/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">实践：爬取前程无忧数据并做分析</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/AngelNI.github.io/doc-to-pdf/" title="python脚本 Doc 转 PDF"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/216.webp"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-06-25</div><div class="relatedPosts_title">python脚本 Doc 转 PDF</div></div></a></div><div class="relatedPosts_item"><a href="/AngelNI.github.io/spider-maoyantop100/" title="实战:爬取猫眼电影TOP100"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/172.webp"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-05-22</div><div class="relatedPosts_title">实战:爬取猫眼电影TOP100</div></div></a></div><div class="relatedPosts_item"><a href="/AngelNI.github.io/WordCloud/" title="WordCloud——A Beautiful Cloud of Words"><img class="relatedPosts_cover lazyload"data-src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/gallary/6.webp"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2019-07-18</div><div class="relatedPosts_title">WordCloud——A Beautiful Cloud of Words</div></div></a></div></div><div class="clear_both"></div></div><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> Comment</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify: false,
  verify: false,
  appId: 'qPPoge1POJnI2euYtRklvNeY-MdYXbMMI',
  appKey: 'HQ7Jf7U5GYLwyKBwjoLHguWx',
  placeholder: '一起来玩耍鸭！',
  avatar: 'monsterid',
  meta: guest_info,
  pageSize: '10',
  lang: 'en',
  recordIP: false,
  serverURLs: ''
});</script></div></article></main><footer id="footer" style="background-image: url(https://cdn.jsdelivr.net/gh/AngelNI/CDN@5.0/gallary/169.webp)" data-type="photo"><div id="footer-wrap"><div class="copyright">&copy;2020 By Hui Ning</div><div class="framework-info"><span>Driven </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="https://angelni.github.io/">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">简</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="Scroll to comment"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">Local search</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>Powered by</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js" ></script><script src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/js/utils.js" ></script><script src="https://cdn.jsdelivr.net/gh/AngelNI/CDN@3.0/js/main.js" ></script><script src="/AngelNI.github.io/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/AngelNI.github.io/js/third-party/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon_piao" mobile="false" src="/AngelNI.github.io/js/third-party/piao.js"></script><script src="/AngelNI.github.io/js/third-party/activate-power-mode.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script><script src="/AngelNI.github.io/js/search/local-search.js"></script><script>if (document.getElementsByClassName('mermaid').length) {
  loadScript('https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js',function () {
    mermaid.initialize({
      theme: 'default',
  })
})
}</script></body></html>